<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.vitalwave package &mdash; Vital Wave  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/plot_directive.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Healthcare Variables" href="main_content.html" />
    <link rel="prev" title="Vital Wave Library" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Vital Wave
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Vital Wave Library</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">src.vitalwave package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.vitalwave.basic_algos">src.vitalwave.basic_algos module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.basic_algos.butter_filter"><code class="docutils literal notranslate"><span class="pre">butter_filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.basic_algos.calculate_time_delay"><code class="docutils literal notranslate"><span class="pre">calculate_time_delay()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.basic_algos.derivative_filter"><code class="docutils literal notranslate"><span class="pre">derivative_filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.basic_algos.extract_waveforms"><code class="docutils literal notranslate"><span class="pre">extract_waveforms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.basic_algos.filter_hr"><code class="docutils literal notranslate"><span class="pre">filter_hr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.basic_algos.homomorphic_hilbert_envelope"><code class="docutils literal notranslate"><span class="pre">homomorphic_hilbert_envelope()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.basic_algos.min_max_normalize"><code class="docutils literal notranslate"><span class="pre">min_max_normalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.basic_algos.moving_average_filter"><code class="docutils literal notranslate"><span class="pre">moving_average_filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.basic_algos.resample"><code class="docutils literal notranslate"><span class="pre">resample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.basic_algos.segmenting"><code class="docutils literal notranslate"><span class="pre">segmenting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.basic_algos.wavelet_transform_signal"><code class="docutils literal notranslate"><span class="pre">wavelet_transform_signal()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.vitalwave.peak_detectors">src.vitalwave.peak_detectors module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.peak_detectors.ampd"><code class="docutils literal notranslate"><span class="pre">ampd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.peak_detectors.ecg_modified_pan_tompkins"><code class="docutils literal notranslate"><span class="pre">ecg_modified_pan_tompkins()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.peak_detectors.get_peaks_from_ppg_using_segments"><code class="docutils literal notranslate"><span class="pre">get_peaks_from_ppg_using_segments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.peak_detectors.msptd"><code class="docutils literal notranslate"><span class="pre">msptd()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.vitalwave.features">src.vitalwave.features module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.features.compute_meandist"><code class="docutils literal notranslate"><span class="pre">compute_meandist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.features.get_egc_interval_p_t"><code class="docutils literal notranslate"><span class="pre">get_egc_interval_p_t()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.features.get_egc_interval_q_s"><code class="docutils literal notranslate"><span class="pre">get_egc_interval_q_s()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.features.get_egc_interval_q_t"><code class="docutils literal notranslate"><span class="pre">get_egc_interval_q_t()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.features.get_global_egc_features"><code class="docutils literal notranslate"><span class="pre">get_global_egc_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.features.get_ppg_peak_amplitude_ratio"><code class="docutils literal notranslate"><span class="pre">get_ppg_peak_amplitude_ratio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.features.get_ppg_peak_integral_ratio"><code class="docutils literal notranslate"><span class="pre">get_ppg_peak_integral_ratio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.vitalwave.signal_quality">src.vitalwave.signal_quality module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.signal_quality.quality_index_for_waveform"><code class="docutils literal notranslate"><span class="pre">quality_index_for_waveform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src-vitalwave-experimental-module">src.vitalwave.experimental module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.experimental.derive_ppg_signal_peaks"><code class="docutils literal notranslate"><span class="pre">derive_ppg_signal_peaks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.experimental.do_ppg_from_raw_signal"><code class="docutils literal notranslate"><span class="pre">do_ppg_from_raw_signal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.vitalwave.experimental.get_ecg_signal_peaks"><code class="docutils literal notranslate"><span class="pre">get_ecg_signal_peaks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.vitalwave">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="main_content.html">Healthcare Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="main_content.html#vital-wave-measuring-the-heart">Vital Wave - measuring the heart</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Vital Wave</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">Vital Wave Library</a></li>
      <li class="breadcrumb-item active">src.vitalwave package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/src.vitalwave.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="src-vitalwave-package">
<h1>src.vitalwave package<a class="headerlink" href="#src-vitalwave-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-src.vitalwave.basic_algos">
<span id="src-vitalwave-basic-algos-module"></span><h2>src.vitalwave.basic_algos module<a class="headerlink" href="#module-src.vitalwave.basic_algos" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.basic_algos.butter_filter">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.basic_algos.</span></span><span class="sig-name descname"><span class="pre">butter_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/src/vitalwave/basic_algos.html#butter_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.basic_algos.butter_filter" title="Link to this definition"></a></dt>
<dd><p>Performs zero-phase Butterworth filtering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>Signal that will be filtered.</p>
</dd>
<dt><strong>n</strong></dt><dd><p>Order of the filter.</p>
</dd>
<dt><strong>wn</strong></dt><dd><p>Cutoff frequencies.</p>
</dd>
<dt><strong>filter_type</strong></dt><dd><p>Type of the filter. Alternatives: lowpass, highpass, bandpass, bandstop.</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>Sampling frequency of the signal.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>arr_filtered</dt><dd><p>Filtered signal.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Without normalization:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">basic_algos</span><span class="o">.</span><span class="n">butter_filter</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">nd_ecg</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">wn</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">filter_type</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
<p>With normalization:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">basic_algos</span><span class="o">.</span><span class="n">min_max_normalize</span><span class="p">(</span><span class="n">basic_algos</span><span class="o">.</span><span class="n">butter_filter</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">nd_ecg</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">wn</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
                                                        <span class="n">filter_type</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.basic_algos.calculate_time_delay">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.basic_algos.</span></span><span class="sig-name descname"><span class="pre">calculate_time_delay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_ecg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr_ppg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks_ecg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/src/vitalwave/basic_algos.html#calculate_time_delay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.basic_algos.calculate_time_delay" title="Link to this definition"></a></dt>
<dd><p>Calculate time delay between ECG and PPG signals based on corresponding peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr_ecg</strong></dt><dd><p>ECG signal.</p>
</dd>
<dt><strong>arr_ppg</strong></dt><dd><p>PPG signal.</p>
</dd>
<dt><strong>peaks_ecg</strong></dt><dd><p>Peaks in the ECG signal.</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>Sampling frequency.</p>
</dd>
<dt><strong>key</strong></dt><dd><p>Identifier, by default “id”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.ndarray</dt><dd><p>Timestamps of corresponding PPG peaks.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To Syncronize ECG and PPG peaks discovery.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>

<span class="n">time</span><span class="p">,</span> <span class="n">ecg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ppg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">vitalwave.basic_algos</span> <span class="kn">import</span> <span class="n">calculate_time_delay</span>
<span class="kn">from</span> <span class="nn">vitalwave.peak_detectors</span> <span class="kn">import</span> <span class="n">ecg_modified_pan_tompkins</span><span class="p">,</span> <span class="n">msptd</span>

<span class="c1"># calculate ECG r-peaks</span>
<span class="n">ecg_r_peaks</span> <span class="o">=</span> <span class="n">ecg_modified_pan_tompkins</span><span class="p">(</span><span class="n">ecg</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="c1"># calculate ppg peaks and valleys - msptd (Modified Smoothed Peak Detection)</span>
<span class="n">ppg_msptd_peaks</span><span class="p">,</span> <span class="n">ppg_msptd_feet</span> <span class="o">=</span> <span class="n">msptd</span><span class="p">(</span><span class="n">ppg</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">locs_ppg</span> <span class="o">=</span> <span class="n">calculate_time_delay</span><span class="p">(</span><span class="n">arr_ecg</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">arr_ppg</span><span class="o">=</span><span class="n">ppg</span><span class="p">,</span>
                                <span class="n">peaks_ecg</span><span class="o">=</span><span class="n">ecg_r_peaks</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fs</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">ppg</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">ppg_msptd_feet</span><span class="p">],</span> <span class="n">ppg</span><span class="p">[</span><span class="n">ppg_msptd_feet</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">locs_ppg</span><span class="p">],</span> <span class="n">ppg</span><span class="p">[</span><span class="n">locs_ppg</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;sync ECG with PPG &quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/97618103a23e537e32c1bda7644fa238/src-vitalwave-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/2f9ab85d581e66e75cbbcc163ab4d85b/src-vitalwave-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/c0e813b3dd2f0f47977ed4af15582c5f/src-vitalwave-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/e8bc08d4237cfd05cd55d9b74cd4d452/src-vitalwave-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-1.png" class="plot-directive" src="_images/src-vitalwave-1.png" />
</figure>
<p>The results show the systolic PPG-peak discovery with using the ECG-Pan-Tomkins based method.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.basic_algos.derivative_filter">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.basic_algos.</span></span><span class="sig-name descname"><span class="pre">derivative_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/src/vitalwave/basic_algos.html#derivative_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.basic_algos.derivative_filter" title="Link to this definition"></a></dt>
<dd><p>Derivative filtering.</p>
<p>A derivative filter according to Pan-Tompkins algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>Data that will be filtered.</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>Sampling rate.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>arr_filt</dt><dd><p>Filtered data.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To highlight the the peaks and valleys of the original signal.
The use of the derivative filter is linked with the moving_average_filter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">basic_algos</span><span class="o">.</span><span class="n">derivative_filter</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<p>An example to have the functions working together is linked with it.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.basic_algos.extract_waveforms">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.basic_algos.</span></span><span class="sig-name descname"><span class="pre">extract_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fid_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/vitalwave/basic_algos.html#extract_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.basic_algos.extract_waveforms" title="Link to this definition"></a></dt>
<dd><p>Extracts waveforms from a signal using an array of fiducial points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>Signal from which the waveforms are extracted.</p>
</dd>
<dt><strong>fid_points</strong></dt><dd><p>Fiducial points used as a basis for extracting the waveforms.</p>
</dd>
<dt><strong>mode</strong></dt><dd><p>How the fiducial points are used to extract the waveforms:
- fid_to_fid: from one fiducial point to the next one.
For example, from one PPG foot to another one.
- nn_interval: the waveform is extracted around each
fiducial point by taking half of the NN interval before
and after.
- window: the waveform is extracted around each fiducial
point using a window. NOTE: In this case the parameter
window must be defined.</p>
</dd>
<dt><strong>window</strong></dt><dd><p>The number of samples to take around the fiducial points.
The parameter must be odd. The number of samples taken 
from left and right is window // 2.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>waveforms</dt><dd><p>An array of extracted waveforms where each row corresponds
to one waveform.</p>
</dd>
<dt>mean_waveform</dt><dd><p>The calculated mean waveform.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">time</span><span class="p">,</span> <span class="n">ecg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ppg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;PPG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">vitalwave.basic_algos</span> <span class="kn">import</span> <span class="n">extract_waveforms</span>
<span class="kn">from</span> <span class="nn">vitalwave.peak_detectors</span> <span class="kn">import</span> <span class="n">ecg_modified_pan_tompkins</span><span class="p">,</span> <span class="n">msptd</span>

<span class="n">make_odd</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># calculate ECG r-peaks</span>
<span class="n">ecg_r_peaks</span> <span class="o">=</span> <span class="n">ecg_modified_pan_tompkins</span><span class="p">(</span><span class="n">ecg</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="c1"># calculate ppg peaks and valleys - msptd (Modified Smoothed Peak Detection)</span>
<span class="n">ppg_msptd_peaks</span><span class="p">,</span> <span class="n">ppg_msptd_feet</span> <span class="o">=</span> <span class="n">msptd</span><span class="p">(</span><span class="n">ppg</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">ppg_wfs</span><span class="p">,</span> <span class="n">ppg_wfs_mean</span> <span class="o">=</span> <span class="n">extract_waveforms</span><span class="p">(</span><span class="n">ppg</span><span class="p">,</span> <span class="n">ppg_msptd_feet</span><span class="p">,</span> <span class="s1">&#39;fid_to_fid&#39;</span><span class="p">)</span>
<span class="n">ecg_wfs1</span><span class="p">,</span> <span class="n">ecg_wfs1_mean</span> <span class="o">=</span> <span class="n">extract_waveforms</span><span class="p">(</span><span class="n">ecg</span><span class="p">,</span> <span class="n">ecg_r_peaks</span><span class="p">,</span> <span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">make_odd</span><span class="p">(</span><span class="n">fs</span><span class="p">)))</span>
<span class="n">ecg_wfs2</span><span class="p">,</span> <span class="n">ecg_wfs2_mean</span> <span class="o">=</span> <span class="n">extract_waveforms</span><span class="p">(</span><span class="n">ecg</span><span class="p">,</span> <span class="n">ecg_r_peaks</span><span class="p">,</span> <span class="s1">&#39;nn_interval&#39;</span><span class="p">)</span>

<span class="c1"># Plot the waveforms.</span>
<span class="k">def</span> <span class="nf">plot_wfs</span><span class="p">(</span><span class="n">wfs</span><span class="p">,</span> <span class="n">wfs_mean</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
   <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

   <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="n">wfs</span><span class="p">:</span>
      <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wf</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

   <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wfs_mean</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
   <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
   <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_wfs</span><span class="p">(</span><span class="n">ppg_wfs</span><span class="p">,</span> <span class="n">ppg_wfs_mean</span><span class="p">,</span> <span class="s1">&#39;PPG waveforms, feet to feet&#39;</span><span class="p">)</span>
<span class="n">plot_wfs</span><span class="p">(</span><span class="n">ecg_wfs1</span><span class="p">,</span> <span class="n">ecg_wfs1_mean</span><span class="p">,</span> <span class="s1">&#39;ECG waveforms, window&#39;</span><span class="p">)</span>
<span class="n">plot_wfs</span><span class="p">(</span><span class="n">ecg_wfs2</span><span class="p">,</span> <span class="n">ecg_wfs2_mean</span><span class="p">,</span> <span class="s1">&#39;ECG waveforms, NN interval&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/155d6e67d5cde6dbac0d23b1201fa95c/src-vitalwave-2.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id1">
<img alt="_images/src-vitalwave-2_00.png" class="plot-directive" src="_images/src-vitalwave-2_00.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="_downloads/e4a8992f93ea4dce6dbd1dd8e7a3f194/src-vitalwave-2_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/3d03c6643df61261b45743db92308a7d/src-vitalwave-2_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/fa13c464bb00a4971fcd71f4efb4d2dd/src-vitalwave-2_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id2">
<img alt="_images/src-vitalwave-2_01.png" class="plot-directive" src="_images/src-vitalwave-2_01.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="_downloads/f721796a4eb1c576cec4e76e060d2e5c/src-vitalwave-2_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/c72b9625e713a71172e990d62e2ec059/src-vitalwave-2_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/225086ea73d70d154de29c7072639546/src-vitalwave-2_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id3">
<img alt="_images/src-vitalwave-2_02.png" class="plot-directive" src="_images/src-vitalwave-2_02.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="_downloads/91f66539ab6a4c0de7d524fcc960fd7d/src-vitalwave-2_02.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/2b500e48706f61b520b688377fa28b08/src-vitalwave-2_02.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/9a3c0c815b6a4dd00baf0ef6e3e63167/src-vitalwave-2_02.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>To extract the waveforms from the source-signal Fiducial point is required:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.basic_algos.filter_hr">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.basic_algos.</span></span><span class="sig-name descname"><span class="pre">filter_hr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">heart_rates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hr_max_diff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hr_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hr_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">180</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/src/vitalwave/basic_algos.html#filter_hr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.basic_algos.filter_hr" title="Link to this definition"></a></dt>
<dd><p>Filter instantaneous heart rates (HRs) with a median
filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>heart_rates</strong></dt><dd><p>An array of instantaneous HRs [bpm].</p>
</dd>
<dt><strong>kernel_size</strong></dt><dd><p>Kernel size used in the median filter.</p>
</dd>
<dt><strong>hr_max_diff</strong></dt><dd><p>Maximum allowed HR difference [bpm].</p>
</dd>
<dt><strong>hr_min</strong></dt><dd><p>Lowest allowed HR [bpm].</p>
</dd>
<dt><strong>hr_max</strong></dt><dd><p>Highest allowed HR [bpm].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>heart_rates</dt><dd><p>An array of filtered instantaneous HRs.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To calculate the initial heart-beat validity based on an existing set of values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>

<span class="n">time</span><span class="p">,</span> <span class="n">ecg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">vitalwave.basic_algos</span> <span class="kn">import</span> <span class="n">butter_filter</span><span class="p">,</span> <span class="n">filter_hr</span>
<span class="kn">from</span> <span class="nn">vitalwave</span> <span class="kn">import</span> <span class="n">peak_detectors</span>

<span class="n">ecg_filt</span> <span class="o">=</span> <span class="n">butter_filter</span><span class="p">(</span><span class="n">ecg</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">ecg_r_peaks</span> <span class="o">=</span> <span class="n">peak_detectors</span><span class="o">.</span><span class="n">ecg_modified_pan_tompkins</span><span class="p">(</span><span class="n">ecg_filt</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">heart_rates</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">ecg_r_peaks</span><span class="p">])</span>
<span class="n">heart_rates_filt</span> <span class="o">=</span> <span class="n">filter_hr</span><span class="p">(</span><span class="n">heart_rates</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heart_rates</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heart_rates_filt</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Heart rate [bpm]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/5b37be28da511359d27e2cb73202bfa6/src-vitalwave-3.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/5e454b90020d5a010ba0cd80e5ec3883/src-vitalwave-3.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/2af5e17650307fbf0c5c436ecb0ef7d2/src-vitalwave-3.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/b07c5fcf944902e6b137a5b6f4f63163/src-vitalwave-3.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-3.png" class="plot-directive" src="_images/src-vitalwave-3.png" />
</figure>
<p>The results show normal heart-rate variability along with abnormal.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.basic_algos.homomorphic_hilbert_envelope">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.basic_algos.</span></span><span class="sig-name descname"><span class="pre">homomorphic_hilbert_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_fz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/src/vitalwave/basic_algos.html#homomorphic_hilbert_envelope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.basic_algos.homomorphic_hilbert_envelope" title="Link to this definition"></a></dt>
<dd><p>The homomorphic_hilbert_envelope function is applied to enhance the waveform’s envelope. steps:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>signal designed for transformation</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>sample frequency</p>
</dd>
<dt><strong>order</strong></dt><dd><p>sharpness of transition between passband and stopband</p>
</dd>
<dt><strong>cutoff_fz</strong></dt><dd><p>The critical frequency or frequencies of the butter-filter</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>filtered_envelope</dt><dd><p>Filtered envelope of the input signal.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To calculate the homomorphic Hilbert envelope; in order to produce a low-resolution mock-up signal of the original.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>

<span class="n">time</span><span class="p">,</span> <span class="n">ecg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">vitalwave.basic_algos</span> <span class="kn">import</span> <span class="n">homomorphic_hilbert_envelope</span>

<span class="n">ecg_hilbert</span> <span class="o">=</span> <span class="n">homomorphic_hilbert_envelope</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">limits</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">],</span> <span class="n">ecg</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">],</span> <span class="n">ecg_hilbert</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">])</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ECG-signal&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;with Hilbert Envelope&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/42ecb5285ca8da176254b6616dc9d89c/src-vitalwave-4.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/4ed988fadd0e23ef3c211df3a71f6304/src-vitalwave-4.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/83e263e1c177087007e47d2196f530ff/src-vitalwave-4.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/21e24affa89b37021a58d7bee1280b99/src-vitalwave-4.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-4.png" class="plot-directive" src="_images/src-vitalwave-4.png" />
</figure>
<p>The end result is a signal with key features retained from the original signal</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.basic_algos.min_max_normalize">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.basic_algos.</span></span><span class="sig-name descname"><span class="pre">min_max_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/src/vitalwave/basic_algos.html#min_max_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.basic_algos.min_max_normalize" title="Link to this definition"></a></dt>
<dd><p>Min-max normalizes an array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>Signal which will be normalized.</p>
</dd>
<dt><strong>min_val</strong></dt><dd><p>Minimum value of the resulting signal.</p>
</dd>
<dt><strong>max_val</strong></dt><dd><p>Maximum value of the resulting signal.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>Normalized version of arr.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To normalize the signal-values without using the standard-scaler based method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">basic_algos</span><span class="o">.</span><span class="n">min_max_normalize</span><span class="p">(</span><span class="n">arr</span> <span class="o">=</span> <span class="n">nd_ecg</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.basic_algos.moving_average_filter">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.basic_algos.</span></span><span class="sig-name descname"><span class="pre">moving_average_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'triang'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/src/vitalwave/basic_algos.html#moving_average_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.basic_algos.moving_average_filter" title="Link to this definition"></a></dt>
<dd><p>Moving window integration and moving average</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>Data that will be integrated.</p>
</dd>
<dt><strong>window</strong></dt><dd><p>Number of samples in the window.</p>
</dd>
<dt><strong>type</strong></dt><dd><p>Valid types to call for are “triang” and “moving_avg”</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>nd_array</dt><dd><p>Integrated data or moving average data</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To produce a distorted signal highlighting the r-peak in the QRS-complex of the ECG.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">vitalwave.basic_algos</span> <span class="kn">import</span> <span class="n">moving_average_filter</span>
<span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]</span>

<span class="n">time</span><span class="p">,</span> <span class="n">ecg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>
<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="n">nd_arr_triang</span> <span class="o">=</span> <span class="n">moving_average_filter</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fs</span> <span class="o">*</span> <span class="mf">0.15</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">limits</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">],</span> <span class="n">nd_arr_triang</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Smoothing&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/34873cd4be97002103bff7b8f594d77b/src-vitalwave-5.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/6e2de1dbf977eabea0738600f18670ff/src-vitalwave-5.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/9b2f2a9f1ebbcea82ac58eaad5fd6a0a/src-vitalwave-5.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/851d5534e54b2a460b75c75b3b7b13bb/src-vitalwave-5.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-5.png" class="plot-directive" src="_images/src-vitalwave-5.png" />
</figure>
<p>The example is linked with the derivative_filter function found in the same module.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.basic_algos.resample">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.basic_algos.</span></span><span class="sig-name descname"><span class="pre">resample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamps_new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/vitalwave/basic_algos.html#resample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.basic_algos.resample" title="Link to this definition"></a></dt>
<dd><p>Resample a time series to a new time axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>timestamps</strong></dt><dd><p>Original timestamps.</p>
</dd>
<dt><strong>arr</strong></dt><dd><p>Original values.</p>
</dd>
<dt><strong>timestamps_new</strong></dt><dd><p>Timestamps used as the basis in resampling. This must
be in the same unit as timestamps.</p>
</dd>
<dt><strong>dt</strong></dt><dd><p>Timestep of the new time series. This must be
in the same unit as timestamps.</p>
</dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>timestamps_new</strong></dt><dd><p>An array of resampled timestamps.</p>
</dd>
<dt><strong>arr_new</strong></dt><dd><p>An array of resampled values.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To setup new time based frequency to an existing signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">basic_algos</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">timestamps</span> <span class="o">=</span> <span class="n">ecg_ts</span><span class="p">,</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">ecg</span><span class="p">,</span> <span class="n">ts_new</span> <span class="o">=</span> <span class="n">timestamps_new</span><span class="p">)</span>
</pre></div>
</div>
<p>or by proving the <span class="math notranslate nohighlight">\(\Delta\)</span> time variable:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">basic_algos</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">timestamps</span> <span class="o">=</span> <span class="n">ecg_ts</span><span class="p">,</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">ecg</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.basic_algos.segmenting">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.basic_algos.</span></span><span class="sig-name descname"><span class="pre">segmenting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/vitalwave/basic_algos.html#segmenting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.basic_algos.segmenting" title="Link to this definition"></a></dt>
<dd><p>Segment an array into overlapping frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>Input array to segment.</p>
</dd>
<dt><strong>window_size</strong></dt><dd><p>Size of the window.</p>
</dd>
<dt><strong>overlap</strong></dt><dd><p>Overlap between segments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>frames</dt><dd><p>List of segmented frames.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.basic_algos.wavelet_transform_signal">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.basic_algos.</span></span><span class="sig-name descname"><span class="pre">wavelet_transform_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dwt_transform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlevels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_high</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/vitalwave/basic_algos.html#wavelet_transform_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.basic_algos.wavelet_transform_signal" title="Link to this definition"></a></dt>
<dd><p>Designed to work with noisy signal as a first-pass mechanism.</p>
<p>Performs wavelet decomposition on the input channel using pywt.wavedec,
This returns a &lt;list&gt; of coefficients. The coefficients in the specified ranges are
multiplied by zero to remove their contribution.
Finally, a reconstructed signal is returned based on the wavelet coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>signal to process</p>
</dd>
<dt><strong>dwt_transform</strong></dt><dd><p>Wavelet transformation function - good defualt: ‘bior4.4’</p>
</dd>
<dt><strong>dlevels</strong></dt><dd><p>wavedeck: level parameter</p>
</dd>
<dt><strong>cutoff_low</strong></dt><dd><p>the scale up to which coefficients will be zeroed</p>
</dd>
<dt><strong>cutoff_high</strong></dt><dd><p>the scale from which coefficients will be zeroed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>corrected_signal with inverse wavelet transform</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To clean-up noisy signal prior to processing it with the Butterworth bandpass-filter.
The example-code includes the linking with the Butterworth bandpass filter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">vitalwave.basic_algos</span> <span class="kn">import</span> <span class="n">butter_filter</span><span class="p">,</span> <span class="n">min_max_normalize</span><span class="p">,</span> <span class="n">wavelet_transform_signal</span>
<span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>

<span class="n">time</span><span class="p">,</span> <span class="n">ecg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>
<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="n">nd_ecg_denoiced</span> <span class="o">=</span> <span class="n">wavelet_transform_signal</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">dwt_transform</span><span class="o">=</span><span class="s1">&#39;bior4.4&#39;</span><span class="p">,</span> <span class="n">dlevels</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                                           <span class="n">cutoff_low</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cutoff_high</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="n">ecg_filt_cleaned</span> <span class="o">=</span> <span class="n">min_max_normalize</span><span class="p">(</span><span class="n">butter_filter</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">nd_ecg_denoiced</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">wn</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
                                                   <span class="n">filter_type</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">limits</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">],</span> <span class="n">ecg</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">],</span> <span class="n">ecg_filt_cleaned</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">])</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Filtered ECG&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;wavedeck &#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/6ac208dd7ec2be53bf2068b71958710e/src-vitalwave-6.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/f1d9e1d5150c89c7c70c9f5d2a4fd456/src-vitalwave-6.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/3edb85ca0835e4640c8f3690e9e5668f/src-vitalwave-6.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/fbf2902c40876b55d79f6b07dd0e9961/src-vitalwave-6.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-6.png" class="plot-directive" src="_images/src-vitalwave-6.png" />
</figure>
</dd></dl>

</section>
<section id="module-src.vitalwave.peak_detectors">
<span id="src-vitalwave-peak-detectors-module"></span><h2>src.vitalwave.peak_detectors module<a class="headerlink" href="#module-src.vitalwave.peak_detectors" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.peak_detectors.ampd">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.peak_detectors.</span></span><span class="sig-name descname"><span class="pre">ampd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/src/vitalwave/peak_detectors.html#ampd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.peak_detectors.ampd" title="Link to this definition"></a></dt>
<dd><p>Automatic multiscale-based peak detection (AMPD).</p>
<p>Based on the article: <a class="reference external" href="https://doi.org/10.3390/a5040588">https://doi.org/10.3390/a5040588</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>The data for which the peaks are detected.</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>Sampling frequency of the data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>peak_indices</dt><dd><p>Indices for the found peaks in the signal.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the peaks or valleys in a given signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ppg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;PPG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">vitalwave.peak_detectors</span> <span class="kn">import</span> <span class="n">ampd</span>

<span class="c1"># calculate ppg peaks and valleys - ampd (Automated Multi-scale Peak Detection)</span>
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">limits</span>

<span class="n">ppg_ampd_peaks</span> <span class="o">=</span> <span class="n">ampd</span><span class="p">(</span><span class="n">ppg</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">],</span> <span class="n">fs</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fs</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">],</span> <span class="n">ppg</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">][</span><span class="n">ppg_ampd_peaks</span><span class="p">],</span> <span class="n">ppg</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">][</span><span class="n">ppg_ampd_peaks</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Automatic multiscale-based peak detection (AMDP); for PPG&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/6d7efad40abb6db5afd9b41846bdb3b3/src-vitalwave-7.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/ce49f8cde8ad1a560e9e8ac12c4977e2/src-vitalwave-7.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/2cef9bc04c68370f041c7dcb72abea52/src-vitalwave-7.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/a0c40ba049844f2e3cd47f32247e9570/src-vitalwave-7.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-7.png" class="plot-directive" src="_images/src-vitalwave-7.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.peak_detectors.ecg_modified_pan_tompkins">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.peak_detectors.</span></span><span class="sig-name descname"><span class="pre">ecg_modified_pan_tompkins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/src/vitalwave/peak_detectors.html#ecg_modified_pan_tompkins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.peak_detectors.ecg_modified_pan_tompkins" title="Link to this definition"></a></dt>
<dd><p>Detects ECG R peaks using the Pan-Tompkins algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>ECG signal from which the R peaks are detected.</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>ECG signal sampling frequency.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>r_e</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the r-peaks of ECG in a given signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ecg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">vitalwave.peak_detectors</span> <span class="kn">import</span> <span class="n">ecg_modified_pan_tompkins</span>

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">limits</span>

<span class="n">ecg_r_peaks</span> <span class="o">=</span> <span class="n">ecg_modified_pan_tompkins</span><span class="p">(</span><span class="n">ecg</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">],</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[:</span><span class="n">stop</span><span class="p">],</span> <span class="n">ecg</span><span class="p">[:</span><span class="n">stop</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[:</span><span class="n">stop</span><span class="p">][</span><span class="n">ecg_r_peaks</span><span class="p">],</span> <span class="n">ecg</span><span class="p">[:</span><span class="n">stop</span><span class="p">][</span><span class="n">ecg_r_peaks</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;ECG r-peaks using Pan Tompkins&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/7c48a64fcb892d05fc6723c2d88ba383/src-vitalwave-8.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/1629230dd60cbc7d229352f414060479/src-vitalwave-8.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/e0465a183e82f6d1e251538bd623b6c4/src-vitalwave-8.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/5e5c6da044ee46ed6278ccc4cfad8f88/src-vitalwave-8.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-8.png" class="plot-directive" src="_images/src-vitalwave-8.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.peak_detectors.get_peaks_from_ppg_using_segments">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.peak_detectors.</span></span><span class="sig-name descname"><span class="pre">get_peaks_from_ppg_using_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_overlap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_integration_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_peaks_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/vitalwave/peak_detectors.html#get_peaks_from_ppg_using_segments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.peak_detectors.get_peaks_from_ppg_using_segments" title="Link to this definition"></a></dt>
<dd><p>Extract PPG (Photoplethysmogram) peaks from raw data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>Raw input signal.</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>Sampling frequency of the signal.</p>
</dd>
<dt><strong>set_overlap</strong></dt><dd><p>Overlap between segments (used when segment &gt; 0).</p>
</dd>
<dt><strong>signal_integration_window</strong></dt><dd><p>Integration window for signal processing (default is 0, indicating no integration).</p>
</dd>
<dt><strong>segment</strong><span class="classifier">optional</span></dt><dd><p>Number of segments to split the signal into (default is 3). Set to 0 for non-segmented processing.</p>
</dd>
<dt><strong>get_peaks_only:</strong></dt><dd><p>used to get peaks only or both as sorted ndarray</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>all_peaks</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array containing all detected PPG peaks.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the peaks or valleys in a given signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">time</span><span class="p">,</span> <span class="n">ppg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;PPG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">vitalwave.peak_detectors</span> <span class="kn">import</span> <span class="n">get_peaks_from_ppg_using_segments</span>

<span class="n">ppg_peaks</span> <span class="o">=</span> <span class="n">get_peaks_from_ppg_using_segments</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ppg</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fs</span><span class="p">),</span> <span class="n">set_overlap</span> <span class="o">=</span> <span class="p">(</span><span class="n">fs</span> <span class="o">*</span> <span class="mi">2</span><span class="p">),</span>
                                              <span class="n">get_peaks_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">ppg</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">ppg_peaks</span><span class="p">],</span> <span class="n">ppg</span><span class="p">[</span><span class="n">ppg_peaks</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/fcb9d26f82d9b4cbc4d7aff867953f64/src-vitalwave-9.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/02bf834513e7c95403066e62868ce447/src-vitalwave-9.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/f857115d072ea4a09f7d11f513972d8f/src-vitalwave-9.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/58a4af33126a41732d66c4506d394652/src-vitalwave-9.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-9.png" class="plot-directive" src="_images/src-vitalwave-9.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.peak_detectors.msptd">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.peak_detectors.</span></span><span class="sig-name descname"><span class="pre">msptd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/vitalwave/peak_detectors.html#msptd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.peak_detectors.msptd" title="Link to this definition"></a></dt>
<dd><p>Modified automatic multiscale-based peak detection (AMPD).</p>
<p>Based on the Matlab implementation presented in the 
article: <a class="reference external" href="https://doi.org/10.1007/978-3-319-65798-1_39">https://doi.org/10.1007/978-3-319-65798-1_39</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>The data for which the peaks and troughs are detected</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>Sampling frequency of the data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>peaks</dt><dd><p>Indices for the found peaks.</p>
</dd>
<dt>troughs</dt><dd><p>Indices for the found troughs.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the peaks and valleys in a given signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ppg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;PPG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">vitalwave.peak_detectors</span> <span class="kn">import</span> <span class="n">msptd</span>

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">limits</span>

<span class="c1"># calculate ppg peaks and valleys - msptd (Modified Smoothed Peak Detection)</span>
<span class="n">ppg_msptd_peaks</span><span class="p">,</span> <span class="n">ppg_msptd_feet</span> <span class="o">=</span> <span class="n">msptd</span><span class="p">(</span><span class="n">ppg</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">],</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[:</span><span class="n">stop</span><span class="p">],</span> <span class="n">ppg</span><span class="p">[:</span><span class="n">stop</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[:</span><span class="n">stop</span><span class="p">][</span><span class="n">ppg_msptd_peaks</span><span class="p">],</span> <span class="n">ppg</span><span class="p">[:</span><span class="n">stop</span><span class="p">][</span><span class="n">ppg_msptd_peaks</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[:</span><span class="n">stop</span><span class="p">][</span><span class="n">ppg_msptd_feet</span><span class="p">],</span> <span class="n">ppg</span><span class="p">[:</span><span class="n">stop</span><span class="p">][</span><span class="n">ppg_msptd_feet</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Modified AMDP Peak Detection; for PPG&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/e51e34b64415d2bab48fd00950ded21b/src-vitalwave-10.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/f32e6e6768d7036ba29b913246c4e9db/src-vitalwave-10.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/fa2df5154bdb405d36f281216aef7fbc/src-vitalwave-10.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/9bec14856365520e89685d1bccb9e138/src-vitalwave-10.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-10.png" class="plot-directive" src="_images/src-vitalwave-10.png" />
</figure>
</dd></dl>

</section>
<section id="module-src.vitalwave.features">
<span id="src-vitalwave-features-module"></span><h2>src.vitalwave.features module<a class="headerlink" href="#module-src.vitalwave.features" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.features.compute_meandist">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.features.</span></span><span class="sig-name descname"><span class="pre">compute_meandist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diff_rri</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/vitalwave/features.html#compute_meandist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.features.compute_meandist" title="Link to this definition"></a></dt>
<dd><p>Computes the mean distance between successive elements in a given time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>diff_rri</strong></dt><dd><p>he input time series data representing the successive differences of R-R intervals.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float:</dt><dd><p>The calculated mean distance value.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.features.get_egc_interval_p_t">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.features.</span></span><span class="sig-name descname"><span class="pre">get_egc_interval_p_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/vitalwave/features.html#get_egc_interval_p_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.features.get_egc_interval_p_t" title="Link to this definition"></a></dt>
<dd><p>Calculate the time intervals between Q and T points in an ECG signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>ECG signal</p>
</dd>
<dt><strong>p_points</strong></dt><dd><p>A list of indices representing the P points in the ECG signal.</p>
</dd>
<dt><strong>t_points</strong></dt><dd><p>A list of indices representing the T points in the ECG signal.</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>The sampling frequency of the ECG signal in Hz. Default is 200 Hz.</p>
</dd>
<dt><strong>max_len</strong><span class="classifier">int, optional</span></dt><dd><p>Scroll-distance to discover the valleys. Default is 50.</p>
</dd>
<dt><strong>threshold</strong><span class="classifier">float, optional</span></dt><dd><p>The threshold for identifying valleys. Default is 0.0001.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>list</dt><dd><p>A list of time intervals in seconds between the Q and T points in the ECG signal.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the interval between p and t-peaks ratios in a given signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ecg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">src.vitalwave.features</span> <span class="kn">import</span> <span class="n">get_egc_interval_p_t</span>
<span class="kn">from</span> <span class="nn">src.vitalwave</span> <span class="kn">import</span> <span class="n">peak_detectors</span>
<span class="kn">from</span> <span class="nn">src.vitalwave.experimental</span> <span class="kn">import</span> <span class="n">get_ecg_signal_peaks</span>

<span class="n">ecg_r_peaks</span> <span class="o">=</span> <span class="n">peak_detectors</span><span class="o">.</span><span class="n">ecg_modified_pan_tompkins</span><span class="p">(</span><span class="n">ecg</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>

<span class="n">nd_ecg_with_peaks</span><span class="p">,</span> <span class="n">nd_ecg_with_peak_types</span> <span class="o">=</span> <span class="n">get_ecg_signal_peaks</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">r_peaks</span><span class="o">=</span><span class="n">ecg_r_peaks</span><span class="p">,</span>
                                                                 <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">egc_p_peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ecg_with_peak_types</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">egc_t_peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ecg_with_peak_types</span> <span class="o">==</span> <span class="mf">5.0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">interval</span> <span class="o">=</span> <span class="n">get_egc_interval_p_t</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">p_points</span><span class="o">=</span><span class="n">egc_p_peaks</span><span class="p">,</span> <span class="n">t_points</span><span class="o">=</span><span class="n">egc_t_peaks</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/4a49841c35838a95f93c863ee872981f/src-vitalwave-11.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/c0c63df8ce1c60b18bbf48ba627a51cb/src-vitalwave-11.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/b4d8d88b5a2b8dacdacc3b4004cc7b7f/src-vitalwave-11.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/1636053823d3aecce76ac6ab10b86a00/src-vitalwave-11.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-11.png" class="plot-directive" src="_images/src-vitalwave-11.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.features.get_egc_interval_q_s">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.features.</span></span><span class="sig-name descname"><span class="pre">get_egc_interval_q_s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/vitalwave/features.html#get_egc_interval_q_s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.features.get_egc_interval_q_s" title="Link to this definition"></a></dt>
<dd><p>Calculate the time intervals between Q and S points in an ECG signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>ECG signal</p>
</dd>
<dt><strong>q_points</strong></dt><dd><p>A list of indices representing the Q points in the ECG signal.</p>
</dd>
<dt><strong>s_points</strong></dt><dd><p>A list of indices representing the S points in the ECG signal.</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>The sampling frequency of the ECG signal in Hz. Default is 200 Hz.</p>
</dd>
<dt><strong>max_len</strong><span class="classifier">int, optional</span></dt><dd><p>Scroll-distance to discover the valleys. Default is 50.</p>
</dd>
<dt><strong>threshold</strong><span class="classifier">float, optional</span></dt><dd><p>The threshold for identifying valleys. Default is 0.0001.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>list</dt><dd><p>A list of time intervals in seconds between the Q and S points in the ECG signal.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the interval between q and s-peak ratios in a given signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ecg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">src.vitalwave.features</span> <span class="kn">import</span> <span class="n">get_egc_interval_q_s</span>
<span class="kn">from</span> <span class="nn">src.vitalwave</span> <span class="kn">import</span> <span class="n">peak_detectors</span>
<span class="kn">from</span> <span class="nn">src.vitalwave.experimental</span> <span class="kn">import</span> <span class="n">get_ecg_signal_peaks</span>

<span class="n">ecg_r_peaks</span> <span class="o">=</span> <span class="n">peak_detectors</span><span class="o">.</span><span class="n">ecg_modified_pan_tompkins</span><span class="p">(</span><span class="n">ecg</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>

<span class="n">nd_ecg_with_peaks</span><span class="p">,</span> <span class="n">nd_ecg_with_peak_types</span> <span class="o">=</span> <span class="n">get_ecg_signal_peaks</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">r_peaks</span><span class="o">=</span><span class="n">ecg_r_peaks</span><span class="p">,</span>
                                                                 <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">egc_q_notch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ecg_with_peak_types</span> <span class="o">==</span> <span class="mf">2.0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">egc_s_notch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ecg_with_peak_types</span> <span class="o">==</span> <span class="mf">4.0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">interval</span> <span class="o">=</span> <span class="n">get_egc_interval_q_s</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">q_points</span><span class="o">=</span><span class="n">egc_q_notch</span><span class="p">,</span> <span class="n">s_points</span><span class="o">=</span><span class="n">egc_s_notch</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/de87225a067b07389fcd057e1eef0d3f/src-vitalwave-12.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/19e82fef17b74e7f082c73591f04416c/src-vitalwave-12.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/8badb29de0bfe9aee918dd9dd665fdd5/src-vitalwave-12.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/94d19a1d11a804ba8676fe62c6cba460/src-vitalwave-12.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-12.png" class="plot-directive" src="_images/src-vitalwave-12.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.features.get_egc_interval_q_t">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.features.</span></span><span class="sig-name descname"><span class="pre">get_egc_interval_q_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/vitalwave/features.html#get_egc_interval_q_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.features.get_egc_interval_q_t" title="Link to this definition"></a></dt>
<dd><p>Calculate the time intervals between Q and T points in an ECG signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>ECG signal</p>
</dd>
<dt><strong>q_points</strong></dt><dd><p>A list of indices representing the Q points in the ECG signal.</p>
</dd>
<dt><strong>t_points</strong></dt><dd><p>A list of indices representing the T points in the ECG signal.</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>The sampling frequency of the ECG signal in Hz. Default is 200 Hz.</p>
</dd>
<dt><strong>max_len</strong><span class="classifier">int, optional</span></dt><dd><p>Scroll-distance to discover the valleys. Default is 50.</p>
</dd>
<dt><strong>threshold</strong><span class="classifier">float, optional</span></dt><dd><p>The threshold for identifying valleys. Default is 0.0001.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>list</dt><dd><p>A list of time intervals in seconds between the Q and T points in the ECG signal.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the interval between q and t-peaks ratios in a given signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ecg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">src.vitalwave.features</span> <span class="kn">import</span> <span class="n">get_egc_interval_q_t</span>
<span class="kn">from</span> <span class="nn">vitalwave</span> <span class="kn">import</span> <span class="n">peak_detectors</span>
<span class="kn">from</span> <span class="nn">src.vitalwave.experimental</span> <span class="kn">import</span> <span class="n">get_ecg_signal_peaks</span>

<span class="n">ecg_r_peaks</span> <span class="o">=</span> <span class="n">peak_detectors</span><span class="o">.</span><span class="n">ecg_modified_pan_tompkins</span><span class="p">(</span><span class="n">ecg</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>

<span class="n">nd_ecg_with_peaks</span><span class="p">,</span> <span class="n">nd_ecg_with_peak_types</span> <span class="o">=</span> <span class="n">get_ecg_signal_peaks</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">r_peaks</span><span class="o">=</span><span class="n">ecg_r_peaks</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">egc_q_peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ecg_with_peak_types</span> <span class="o">==</span> <span class="mf">2.0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">egc_t_peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ecg_with_peak_types</span> <span class="o">==</span> <span class="mf">5.0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">interval</span> <span class="o">=</span> <span class="n">get_egc_interval_q_t</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">q_points</span><span class="o">=</span><span class="n">egc_q_peaks</span><span class="p">,</span> <span class="n">t_points</span><span class="o">=</span><span class="n">egc_t_peaks</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/8464ec6cf3fbba9e483b5c8eef78bdc4/src-vitalwave-13.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/3d5b3028ed47659affd8f618ae25ec86/src-vitalwave-13.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/fe6a436271092b2116cb1f7fe1c86869/src-vitalwave-13.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/cb819a3cda64d7c5e51152af41016fa2/src-vitalwave-13.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-13.png" class="plot-directive" src="_images/src-vitalwave-13.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.features.get_global_egc_features">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.features.</span></span><span class="sig-name descname"><span class="pre">get_global_egc_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_peaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rr_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/vitalwave/features.html#get_global_egc_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.features.get_global_egc_features" title="Link to this definition"></a></dt>
<dd><p>Calculate global ECG (Electrocardiogram) features from R-peak indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>r_peaks</strong></dt><dd><p>List of R-peak indices in the ECG signal.</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>Sampling frequency of the ECG signal in Hz.</p>
</dd>
<dt><strong>min_rr_interval</strong></dt><dd><p>Minimum RR interval in milliseconds, used for computing pNNxx.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>object</dt><dd><p>containing scalar variables</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.features.get_ppg_peak_amplitude_ratio">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.features.</span></span><span class="sig-name descname"><span class="pre">get_ppg_peak_amplitude_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">systolic_peaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diastolic_peaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/src/vitalwave/features.html#get_ppg_peak_amplitude_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.features.get_ppg_peak_amplitude_ratio" title="Link to this definition"></a></dt>
<dd><p>Calculate the amplitude ratio between systolic and diastolic peaks in an array.</p>
<dl class="simple">
<dt>amplitude_ratio = get_amplitude_ratio(arr = nd_ppg_peaks[“filt_ppg_signal”], feets = ppg_feets,</dt><dd><p>systolic_peaks=ppg_systolic, diastolic_peaks=ppg_diastolic)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>An array containing the data.</p>
</dd>
<dt><strong>feets</strong></dt><dd><p>An array of indices representing the feets (or footprints) of specific events.</p>
</dd>
<dt><strong>systolic_peaks</strong></dt><dd><p>An array of indices representing the systolic peaks.</p>
</dd>
<dt><strong>diastolic_peaks</strong></dt><dd><p>An array of indices representing the diastolic peaks.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>list</dt><dd><p>A list of amplitude ratios calculated as arr[systolic_peaks[index]] / arr[diastolic_peaks[index]].</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the amplitude ratios of the systolic and diastolic peaks in a given signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ppg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;PPG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">vitalwave.features</span> <span class="kn">import</span> <span class="n">get_ppg_peak_amplitude_ratio</span>
<span class="kn">from</span> <span class="nn">vitalwave.peak_detectors</span> <span class="kn">import</span> <span class="n">msptd</span>

<span class="kn">from</span> <span class="nn">src.vitalwave.experimental</span> <span class="kn">import</span> <span class="n">derive_ppg_signal_peaks</span>

<span class="n">ppg_peaks</span><span class="p">,</span> <span class="n">ppg_feets</span> <span class="o">=</span> <span class="n">msptd</span><span class="p">(</span><span class="n">ppg</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">nd_ppg_with_peaks</span><span class="p">,</span> <span class="n">nd_ppg_with_peak_types</span> <span class="o">=</span> <span class="n">derive_ppg_signal_peaks</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ppg</span><span class="p">,</span>
                                                                    <span class="n">ppg_peaks</span><span class="o">=</span><span class="n">ppg_peaks</span><span class="p">,</span> <span class="n">ppg_feets</span><span class="o">=</span><span class="n">ppg_feets</span><span class="p">,</span>
                                                                    <span class="n">window_length</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">polyorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ppg_feets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ppg_with_peak_types</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ppg_systolic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ppg_with_peak_types</span> <span class="o">==</span> <span class="mf">2.0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ppg_diastolic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ppg_with_peak_types</span> <span class="o">==</span> <span class="mf">4.0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">l_ratio</span> <span class="o">=</span> <span class="n">get_ppg_peak_amplitude_ratio</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ppg</span><span class="p">,</span> <span class="n">feets</span><span class="o">=</span><span class="n">ppg_feets</span><span class="p">,</span> <span class="n">systolic_peaks</span><span class="o">=</span><span class="n">ppg_systolic</span><span class="p">,</span>
                                       <span class="n">diastolic_peaks</span><span class="o">=</span><span class="n">ppg_diastolic</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">l_ratio</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/f2667077b6c7f2269bb5e404323829dc/src-vitalwave-14.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/ac6a88a5c28269d6118da11f36705be3/src-vitalwave-14.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/f173d2c7c154f401bad498dcbddf7a57/src-vitalwave-14.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/dcf08dd5dc91ca0b71e9e277f47840db/src-vitalwave-14.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-14.png" class="plot-directive" src="_images/src-vitalwave-14.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.features.get_ppg_peak_integral_ratio">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.features.</span></span><span class="sig-name descname"><span class="pre">get_ppg_peak_integral_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dicrotic_valley</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">problems</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/src/vitalwave/features.html#get_ppg_peak_integral_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.features.get_ppg_peak_integral_ratio" title="Link to this definition"></a></dt>
<dd><p>Calculate the integral ratio between systolic and diastolic intervals in an array.</p>
<dl class="simple">
<dt>integrals = get_integral_ratio(arr = nd_ppg_peaks[“filt_ppg_signal”], feets = ppg_feets,</dt><dd><p>dicrotic_valley = ppg_dicrotic, problems = [121])</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>An array containing the data.</p>
</dd>
<dt><strong>feets</strong></dt><dd><p>An array of indices representing the feets (or footprints) of specific events.</p>
</dd>
<dt><strong>dicrotic_valley</strong></dt><dd><p>An array of indices representing the dicrotic valleys.</p>
</dd>
<dt><strong>problems</strong></dt><dd><p>An array of indices representing problematic data points to be excluded from calculations.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>list</dt><dd><p>A list of integral ratios calculated as the volume of systolic to diastolic peak.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the volume-ratios of the systolic and diastolic peaks in a given signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ppg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;PPG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">src.vitalwave.features</span> <span class="kn">import</span> <span class="n">get_ppg_peak_integral_ratio</span>

<span class="kn">from</span> <span class="nn">vitalwave.peak_detectors</span> <span class="kn">import</span> <span class="n">msptd</span>
<span class="kn">from</span> <span class="nn">src.vitalwave.experimental</span> <span class="kn">import</span> <span class="n">derive_ppg_signal_peaks</span>

<span class="n">ppg_peaks</span><span class="p">,</span> <span class="n">ppg_feets</span> <span class="o">=</span> <span class="n">msptd</span><span class="p">(</span><span class="n">ppg</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">nd_ppg_with_peaks</span><span class="p">,</span> <span class="n">nd_ppg_with_peak_types</span> <span class="o">=</span> <span class="n">derive_ppg_signal_peaks</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ppg</span><span class="p">,</span>
                                                                    <span class="n">ppg_peaks</span><span class="o">=</span><span class="n">ppg_peaks</span><span class="p">,</span> <span class="n">ppg_feets</span><span class="o">=</span><span class="n">ppg_feets</span><span class="p">,</span>
                                                                    <span class="n">window_length</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">polyorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ppg_feets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ppg_with_peak_types</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ppg_dicrotic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ppg_with_peak_types</span> <span class="o">==</span> <span class="mf">3.0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">l_ratio</span> <span class="o">=</span> <span class="n">get_ppg_peak_integral_ratio</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ppg</span><span class="p">,</span> <span class="n">feets</span><span class="o">=</span><span class="n">ppg_feets</span><span class="p">,</span>
                                      <span class="n">dicrotic_valley</span><span class="o">=</span><span class="n">ppg_dicrotic</span><span class="p">,</span> <span class="n">problems</span><span class="o">=</span><span class="p">[</span><span class="mi">121</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">l_ratio</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/5aac7f645aaac48dc368531e6cdf4355/src-vitalwave-15.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/f00b13136edacc888a6a000d0b7455b7/src-vitalwave-15.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/66eebe5e11be5a76de02ffa97b667c21/src-vitalwave-15.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/76b15b754f8e2b57f46740fc4bfc053a/src-vitalwave-15.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-15.png" class="plot-directive" src="_images/src-vitalwave-15.png" />
</figure>
</dd></dl>

</section>
<section id="module-src.vitalwave.signal_quality">
<span id="src-vitalwave-signal-quality-module"></span><h2>src.vitalwave.signal_quality module<a class="headerlink" href="#module-src.vitalwave.signal_quality" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.signal_quality.quality_index_for_waveform">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.signal_quality.</span></span><span class="sig-name descname"><span class="pre">quality_index_for_waveform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_peaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'scalar'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/src/vitalwave/signal_quality.html#quality_index_for_waveform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.signal_quality.quality_index_for_waveform" title="Link to this definition"></a></dt>
<dd><p>Compute the correlation coefficient between each individual waveform with the average template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>The ECG signal.</p>
</dd>
<dt><strong>r_peaks</strong></dt><dd><p>An array containing the indices of detected R-peaks in the ECG signal.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>list</dt><dd><p>containing correlation coefficients and p-values for each individual waveform compared to the average template.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the r-peaks of ECG in a given signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ecg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">vitalwave.signal_quality</span> <span class="kn">import</span> <span class="n">quality_index_for_waveform</span>
<span class="kn">from</span> <span class="nn">vitalwave</span> <span class="kn">import</span> <span class="n">peak_detectors</span>

<span class="n">ecg_r_peaks</span> <span class="o">=</span> <span class="n">peak_detectors</span><span class="o">.</span><span class="n">ecg_modified_pan_tompkins</span><span class="p">(</span><span class="n">ecg</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>

<span class="n">l_correlation</span> <span class="o">=</span> <span class="n">quality_index_for_waveform</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">r_peaks</span><span class="o">=</span><span class="n">ecg_r_peaks</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;waveform&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">l_correlation</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/4f779d1d2394d43e9928a221e6eaf01c/src-vitalwave-16.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/ea1dca6f249dcf8ad0b8cab4d95bb793/src-vitalwave-16.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/0a2e63952e4f14d7fe5f7b410a307f2c/src-vitalwave-16.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/41a9170cf0477c909d4ae50c2f7a5928/src-vitalwave-16.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-16.png" class="plot-directive" src="_images/src-vitalwave-16.png" />
</figure>
</dd></dl>

</section>
<section id="src-vitalwave-experimental-module">
<h2>src.vitalwave.experimental module<a class="headerlink" href="#src-vitalwave-experimental-module" title="Link to this heading"></a></h2>
<span class="target" id="module-src.vitalwave.experimental"></span><dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.experimental.derive_ppg_signal_peaks">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.experimental.</span></span><span class="sig-name descname"><span class="pre">derive_ppg_signal_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ppg_peaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ppg_feets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/src/vitalwave/experimental.html#derive_ppg_signal_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.experimental.derive_ppg_signal_peaks" title="Link to this definition"></a></dt>
<dd><p>Derive and categorize PPG signal peaks based on waveforms and peak types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong></dt><dd><p>The PPG signal.</p>
</dd>
<dt><strong>ppg_peaks</strong></dt><dd><p>Indices of detected peaks in the PPG signal.</p>
</dd>
<dt><strong>ppg_feets</strong></dt><dd><p>Indices of calculated foot points.</p>
</dd>
<dt><strong>window_length</strong></dt><dd><p>Window length for the Savitzky-Golay filter, by default 9.</p>
</dd>
<dt><strong>polyorder</strong></dt><dd><p>Polynomial order for the Savitzky-Golay filter, by default 5.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>nd_ppg_with_peaks</dt><dd><p>1-D binary array indicating the presence of identified dicrotic and diastolic peaks in the PPG signal.</p>
</dd>
<dt>nd_ppg_with_peak_types</dt><dd><p>1-D array categorizing the identified dicrotic and diastolic peaks in the PPG signal:
- 1: feet
- 2: Systolic peak
- 3: Dicrotic notch
- 4: Diastolic peak</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the r-peaks of ECG in a given signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ppg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;PPG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">src.vitalwave.experimental</span> <span class="kn">import</span> <span class="n">derive_ppg_signal_peaks</span>
<span class="kn">from</span> <span class="nn">vitalwave.peak_detectors</span> <span class="kn">import</span> <span class="n">msptd</span>

<span class="n">ppg_signal</span> <span class="o">=</span> <span class="n">ppg</span>

<span class="n">ppg_peaks</span><span class="p">,</span> <span class="n">ppg_feets</span> <span class="o">=</span> <span class="n">msptd</span><span class="p">(</span><span class="n">ppg</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">heights_peaks</span> <span class="o">=</span> <span class="n">ppg</span><span class="p">[</span><span class="n">ppg_peaks</span><span class="p">]</span>
<span class="n">heights_feets</span> <span class="o">=</span> <span class="n">ppg</span><span class="p">[</span><span class="n">ppg_feets</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ppg</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ppg_peaks</span><span class="p">,</span> <span class="n">heights_peaks</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ppg_feets</span><span class="p">,</span> <span class="n">heights_feets</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/44bf6bb4a04f4378ad995eb810888b03/src-vitalwave-17.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/03c10048977ec4f3408b35b7be6b523f/src-vitalwave-17_00_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/45e700f7de4343757a64dacdd4cb13fd/src-vitalwave-17_00_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/03a1a6cb72dc341e9110579113787250/src-vitalwave-17_00_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-17_00_00.png" class="plot-directive" src="_images/src-vitalwave-17_00_00.png" />
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nd_ppg_with_peaks</span><span class="p">,</span> <span class="n">nd_ppg_with_peak_types</span> <span class="o">=</span> <span class="n">derive_ppg_signal_peaks</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ppg</span><span class="p">,</span>
                                                                    <span class="n">ppg_peaks</span><span class="o">=</span><span class="n">ppg_peaks</span><span class="p">,</span>
                                                                    <span class="n">ppg_feets</span><span class="o">=</span><span class="n">ppg_feets</span><span class="p">,</span>
                                                                    <span class="n">window_length</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                                                                    <span class="n">polyorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ppg</span><span class="p">)</span>

<span class="n">ecg_peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ppg_with_peaks</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">heights_peaks</span> <span class="o">=</span> <span class="n">ppg</span><span class="p">[</span><span class="n">ecg_peaks</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ecg_peaks</span><span class="p">,</span> <span class="n">heights_peaks</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ppg_feets</span><span class="p">,</span> <span class="n">heights_feets</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/39a6b67bff1bfdcfcdb3fa6dacd2c7a2/src-vitalwave-17_01_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/9b7c1f66915075d087f28f2c0526aff3/src-vitalwave-17_01_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/86ea760330582f96fdbbd01f45aa8dc7/src-vitalwave-17_01_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-17_01_00.png" class="plot-directive" src="_images/src-vitalwave-17_01_00.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.experimental.do_ppg_from_raw_signal">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.experimental.</span></span><span class="sig-name descname"><span class="pre">do_ppg_from_raw_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_integration_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_as_segment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/vitalwave/experimental.html#do_ppg_from_raw_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.experimental.do_ppg_from_raw_signal" title="Link to this definition"></a></dt>
<dd><p>Process PPG data from raw signals, segmenting and detecting anomalies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong><span class="classifier">np.ndarray</span></dt><dd><p>Raw PPG signal.</p>
</dd>
<dt><strong>fs</strong><span class="classifier">float</span></dt><dd><p>Sampling frequency.</p>
</dd>
<dt><strong>signal_integration_window</strong><span class="classifier">float, optional</span></dt><dd><p>Integration window size (default is 0).
If greater than 0, the function will perform area under the curve integration.</p>
</dd>
<dt><strong>segment</strong><span class="classifier">int, optional</span></dt><dd><p>Number of segments to divide the signal into (default is 2).
If set to 0, the function will process the entire array as a single segment.</p>
</dd>
<dt><strong>threshold</strong><span class="classifier">float, optional</span></dt><dd><p>Threshold for anomaly detection (default is 2).
Anomalies are detected based on the differences between consecutive peaks.
Peaks with differences greater than this threshold are considered anomalies.</p>
</dd>
<dt><strong>return_as_segment</strong><span class="classifier">bool, optional</span></dt><dd><p>If False (default), returns a single array with segments (or the complete signal)
without anomalies.
If True, returns individual segments along with any detected anomalies.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ppg signal</strong><span class="classifier">list of np.ndarray</span></dt><dd><p>Segmented or complete PPG signal.</p>
</dd>
<dt><strong>peaks_all</strong><span class="classifier">list of np.ndarray</span></dt><dd><p>Detected peaks.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If segmentation is enabled (segment &gt; 0), the function divides the signal into multiple
segments and detects peaks within each segment. Anomalies are detected based on the
differences between consecutive peak indices. Segments without anomalies are returned.</p>
<p>If segmentation is disabled (segment = 0), the entire input signal is processed as a
single segment.</p>
<dl class="simple">
<dt>ppg_data, peak_indices = do_ppg_from_raw_signal(arr = nd_ppg[“ppg_1_ir”], fs = fs, segment = 6,</dt><dd><p>threshold = 3, return_as_segment=True)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To preprocess, validate, and find the peaks or valleys in a ppg signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ppg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;PPG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">vitalwave.experimental</span> <span class="kn">import</span> <span class="n">do_ppg_from_raw_signal</span>

<span class="n">ppg_data_all</span><span class="p">,</span> <span class="n">peak_indices_all</span> <span class="o">=</span> <span class="n">do_ppg_from_raw_signal</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ppg</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">segment</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                                        <span class="n">return_as_segment</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">heights_peaks_all</span> <span class="o">=</span> <span class="n">ppg_data_all</span><span class="p">[</span><span class="n">peak_indices_all</span><span class="p">]</span>

<span class="n">ppg_data</span><span class="p">,</span> <span class="n">peak_indices</span> <span class="o">=</span> <span class="n">do_ppg_from_raw_signal</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ppg</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">segment</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                                <span class="n">return_as_segment</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">heights_peaks</span> <span class="o">=</span> <span class="n">ppg_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">peak_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ppg_data_all</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">peak_indices_all</span><span class="p">,</span> <span class="n">heights_peaks_all</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PPG Data as complete (Segment = 3)&quot;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ppg_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">peak_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">heights_peaks</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PPG Data as segments (Segment = 6)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/a494ed2ce8d16a971344dcb0edc783c8/src-vitalwave-18.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/98864f91ccf985999b810a52805ccfe3/src-vitalwave-18.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/fb588beff09fc550e88e529cee848dff/src-vitalwave-18.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/5a48f5d7c4c9c6971ddce8c2b0293be5/src-vitalwave-18.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-18.png" class="plot-directive" src="_images/src-vitalwave-18.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.vitalwave.experimental.get_ecg_signal_peaks">
<span class="sig-prename descclassname"><span class="pre">src.vitalwave.experimental.</span></span><span class="sig-name descname"><span class="pre">get_ecg_signal_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_peaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/src/vitalwave/experimental.html#get_ecg_signal_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.vitalwave.experimental.get_ecg_signal_peaks" title="Link to this definition"></a></dt>
<dd><p>Extracts and categorizes ECG signal peaks, including R, P, Q, S, and T peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ecg_signal</strong></dt><dd><p>array representing the ECG signal.</p>
</dd>
<dt><strong>r_peaks</strong></dt><dd><p>array containing R-peak locations in samples.</p>
</dd>
<dt><strong>fs</strong></dt><dd><p>Sampling frequency of the ECG signal.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>nd_ecg_with_peaks</dt><dd><p>binary array indicating the presence of identified peaks in the ECG signal.</p>
</dd>
<dt>nd_ecg_with_peak_types</dt><dd><p>array categorizing the identified peaks in the ECG signal:
- 1: P-peak
- 2: Q-peak
- 3: R-peak
- 4: S-peak
- 5: T-peak</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the r-peaks of ECG in a given signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vitalwave.example_data</span> <span class="kn">import</span> <span class="n">load_biosignal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">time</span><span class="p">,</span> <span class="n">ecg</span> <span class="o">=</span> <span class="n">load_biosignal</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ECG&quot;</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">vitalwave</span> <span class="kn">import</span> <span class="n">peak_detectors</span>
<span class="kn">from</span> <span class="nn">vitalwave.experimental</span> <span class="kn">import</span> <span class="n">get_ecg_signal_peaks</span>

<span class="n">ecg_r_peaks</span> <span class="o">=</span> <span class="n">peak_detectors</span><span class="o">.</span><span class="n">ecg_modified_pan_tompkins</span><span class="p">(</span><span class="n">ecg</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">heights_peaks</span> <span class="o">=</span> <span class="n">ecg</span><span class="p">[</span><span class="n">ecg_r_peaks</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ecg</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ecg_r_peaks</span><span class="p">,</span> <span class="n">heights_peaks</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/c6b0f8d3d2bf0fb939f4560cbdeff752/src-vitalwave-19.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/10265591e7d4f726577c3b5793d7161a/src-vitalwave-19_00_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/416d9a106225e2531506eeda7552858b/src-vitalwave-19_00_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/70a33feb4bec92f3110f441f3a5c0df6/src-vitalwave-19_00_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-19_00_00.png" class="plot-directive" src="_images/src-vitalwave-19_00_00.png" />
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nd_ecg_with_peaks</span><span class="p">,</span> <span class="n">nd_ecg_with_peak_types</span> <span class="o">=</span> <span class="n">get_ecg_signal_peaks</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="n">ecg</span><span class="p">,</span> <span class="n">r_peaks</span><span class="o">=</span><span class="n">ecg_r_peaks</span><span class="p">,</span>
                                                                 <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ecg</span><span class="p">)</span>

<span class="n">ecg_peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nd_ecg_with_peaks</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">heights_peaks</span> <span class="o">=</span> <span class="n">ecg</span><span class="p">[</span><span class="n">ecg_peaks</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ecg_peaks</span><span class="p">,</span> <span class="n">heights_peaks</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/54663587075abfd163197dabdec583b7/src-vitalwave-19_01_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/38802865acbb2cea9370d5dfe50d647e/src-vitalwave-19_01_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/cdeb36c9a43745f51979922b3eb3f490/src-vitalwave-19_01_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/src-vitalwave-19_01_00.png" class="plot-directive" src="_images/src-vitalwave-19_01_00.png" />
</figure>
</dd></dl>

</section>
<section id="module-src.vitalwave">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-src.vitalwave" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="Vital Wave Library" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="main_content.html" class="btn btn-neutral float-right" title="Healthcare Variables" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, MW.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>